<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="CDE Accountability Analytics">

<title>CDE R/Git Setup Guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-79912ce8028e1efe7c0b985ea614e92f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#outline-of-steps" id="toc-outline-of-steps" class="nav-link" data-scroll-target="#outline-of-steps">Outline of Steps</a>
  <ul class="collapse">
  <li><a href="#steps-requiring-admin-privileges" id="toc-steps-requiring-admin-privileges" class="nav-link" data-scroll-target="#steps-requiring-admin-privileges">Steps Requiring Admin Privileges</a></li>
  <li><a href="#steps-not-requiring-admin-privileges" id="toc-steps-not-requiring-admin-privileges" class="nav-link" data-scroll-target="#steps-not-requiring-admin-privileges">Steps Not Requiring Admin Privileges</a></li>
  </ul></li>
  <li><a href="#install-r" id="toc-install-r" class="nav-link" data-scroll-target="#install-r">Install R</a></li>
  <li><a href="#install-rtools" id="toc-install-rtools" class="nav-link" data-scroll-target="#install-rtools">Install RTools</a></li>
  <li><a href="#install-r-studio" id="toc-install-r-studio" class="nav-link" data-scroll-target="#install-r-studio">Install R Studio</a></li>
  <li><a href="#install-git" id="toc-install-git" class="nav-link" data-scroll-target="#install-git">Install Git</a></li>
  <li><a href="#install-github-desktop" id="toc-install-github-desktop" class="nav-link" data-scroll-target="#install-github-desktop">Install GitHub Desktop</a></li>
  <li><a href="#create-connection-to-data-warehouse" id="toc-create-connection-to-data-warehouse" class="nav-link" data-scroll-target="#create-connection-to-data-warehouse">Create Connection to Data Warehouse</a></li>
  <li><a href="#create-local-folder-for-repositories" id="toc-create-local-folder-for-repositories" class="nav-link" data-scroll-target="#create-local-folder-for-repositories">Create Local Folder for Repositories</a></li>
  <li><a href="#clone-github-repos-to-your-local-folder" id="toc-clone-github-repos-to-your-local-folder" class="nav-link" data-scroll-target="#clone-github-repos-to-your-local-folder">Clone GitHub Repo(s) to Your Local Folder</a>
  <ul class="collapse">
  <li><a href="#basic-principles-of-version-control-using-git" id="toc-basic-principles-of-version-control-using-git" class="nav-link" data-scroll-target="#basic-principles-of-version-control-using-git">Basic Principles of Version Control using Git</a></li>
  </ul></li>
  <li><a href="#install-r-packages" id="toc-install-r-packages" class="nav-link" data-scroll-target="#install-r-packages">Install R Packages</a>
  <ul class="collapse">
  <li><a href="#how-to-install-and-load-packages" id="toc-how-to-install-and-load-packages" class="nav-link" data-scroll-target="#how-to-install-and-load-packages">How to Install and Load Packages</a></li>
  <li><a href="#overview-of-required-packages" id="toc-overview-of-required-packages" class="nav-link" data-scroll-target="#overview-of-required-packages">Overview of Required Packages</a></li>
  <li><a href="#using-renv" id="toc-using-renv" class="nav-link" data-scroll-target="#using-renv">Using <code>renv</code></a></li>
  </ul></li>
  <li><a href="#set-up-keyring-package" id="toc-set-up-keyring-package" class="nav-link" data-scroll-target="#set-up-keyring-package">Set Up <code>keyring</code> Package</a></li>
  <li><a href="#query-data-from-cde-warehouse" id="toc-query-data-from-cde-warehouse" class="nav-link" data-scroll-target="#query-data-from-cde-warehouse">Query Data from CDE Warehouse</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">CDE R/Git Setup Guide</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>CDE Accountability Analytics </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Welcome to the CDE Data Guide! This document is intended to describe procedures used to set up R studio and the GitHub repositories used by CDE’s ACI team. After completing this process, you should be able to access and run scripts that pull data from CDE’s warehouse (WH) directly through R Studio.</p>
</section>
<section id="outline-of-steps" class="level1">
<h1>Outline of Steps</h1>
<section id="steps-requiring-admin-privileges" class="level2">
<h2 class="anchored" data-anchor-id="steps-requiring-admin-privileges">Steps Requiring Admin Privileges</h2>
<ol type="1">
<li>Install R</li>
<li>Install RTools (optional but recommended)</li>
<li>Install R Studio</li>
<li>Install Git</li>
<li>Install Github Desktop (optional but recommended)</li>
<li>Create Connection to CDE Data Warehouse</li>
</ol>
</section>
<section id="steps-not-requiring-admin-privileges" class="level2">
<h2 class="anchored" data-anchor-id="steps-not-requiring-admin-privileges">Steps Not Requiring Admin Privileges</h2>
<ol start="7" type="1">
<li>Create GitHub Account</li>
<li>Create Local Folder for Code Repositories</li>
<li>Clone a Repository from GitHub
<ol type="a">
<li>Principles of Version Control Using Git</li>
</ol></li>
<li>Install R Packages
<ol type="a">
<li>How to Install Packages</li>
<li>Overview of Required Packages</li>
<li>Using RENV</li>
<li>Set Up keyring Package</li>
</ol></li>
<li>Query Data from Warehouse</li>
<li>Overview of CDE Code Repos</li>
</ol>
</section>
</section>
<section id="install-r" class="level1">
<h1>Install R</h1>
<p>R is the programming language that R Studio is based on. It needs to be installed separately before installing R Studio, which is the IDE (“Integrated Development Environment”) most commonly used with the R language.</p>
<p>As a note, you do not need R Studio to use R. It can also be run through the R console or other IDEs such as VS Code or Positron. However, R Studio is probably the most intuitive and stable way to use R currently. This guide will focus on using R through R Studio.</p>
<p>You can access installation files for R <a href="https://cloud.r-project.org/">here</a>. &nbsp;</p>
<p>Updates to R are typically available a couple times each year. It’s a good idea to periodically update R, although in some cases this will require you to reinstall packages.</p>
</section>
<section id="install-rtools" class="level1">
<h1>Install RTools</h1>
<p>RTools is a set of additional tools used for package development and other advanced tasks in R for Windows. This step is not strictly necessary for most tasks, but it is needed in order to install packages developed by the CDE team directly from GitHub, so you might as well take care of it before installing R Studio.</p>
<p>You can download and install RTools from <a href="https://cran.r-project.org/bin/windows/Rtools/">here</a>.</p>
</section>
<section id="install-r-studio" class="level1">
<h1>Install R Studio</h1>
<p>R Studio is the coding environment (or IDE) most commonly used with the R language.</p>
<ul>
<li>Installation files for R Studio Desktop are available <a href="https://posit.co/download/rstudio-desktop/">here</a>.</li>
<li>Once installed, R Studio should detect your R installation automatically.</li>
<li>You may want to consult this useful <a href="https://docs.posit.co/ide/user/ide/get-started/">Getting Started Guide</a> for R Studio to understand the basic layout and workflow.</li>
</ul>
</section>
<section id="install-git" class="level1">
<h1>Install Git</h1>
<p>Git is a distributed version control system that helps you track and manage changes to files over time. In simple terms, it:</p>
<ul>
<li><p><strong>Tracks Changes:</strong> Git keeps a detailed history of every change made to your files, allowing you to see what was modified, when, and by whom.</p></li>
<li><p><strong>Supports Collaboration:</strong> Because every contributor has a complete copy of the project history, multiple people can work simultaneously on the same project without overwriting each other’s work.</p></li>
<li><p><strong>Enables Experimentation:</strong> With features like branching, you can create separate lines of development (for example, for new features or experiments) without affecting the main project. Once you’re satisfied, you can merge those changes back into the main branch.</p></li>
<li><p><strong>Enhances Recovery:</strong> If something goes wrong, you can easily revert your project to a previous, stable version, reducing the risk of losing work.</p></li>
</ul>
<p>GitHub is the platform built around Git, somewhat (though not exactly) like how R Studio is built around R.</p>
<p>Git installation files can be accessed <a href="https://git-scm.com/downloads">here</a>. Default settings during installation should work fine.</p>
</section>
<section id="install-github-desktop" class="level1">
<h1>Install GitHub Desktop</h1>
<p>Although it’s not strictly necessary to use the desktop version of GitHub’s platform, it’s relatively intuitive and easy to navigate. R Studio and most other IDEs also support Git within their software, and you can also use command line prompts to synchronize via Git, but GitHub desktop provides a graphical interface that may be more convenient.</p>
<p>Download GitHub Desktop <a href="https://desktop.github.com/download/">here</a> and follow instructions to install. You will finish setting this software up after you create a GitHub Account (see below).</p>
</section>
<section id="create-connection-to-data-warehouse" class="level1">
<h1>Create Connection to Data Warehouse</h1>
<p>This step allows applications such as R Studio to communicate with the Oracle Database that comprises CDE’s data warehouse.</p>
<ol type="1">
<li>Open <strong>ODBC Data Source Administrator – 64 Bit</strong> on your laptop (search for it using the Start menu) and click “Add”.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/odbc.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="476"></p>
</figure>
</div>
<ol start="2" type="1">
<li>Choose <strong>Oracle in OraClient 12Home1</strong> driver.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/oracledriver.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="458"></p>
</figure>
</div>
<ol start="3" type="1">
<li>Click Finish and add info for the data source you want to connect to (e.g., EDWP, EDWQA, etc). Type the User ID that you use for Toad, then click Test Connection.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/driver-config.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="432"></p>
</figure>
</div>
<ol start="4" type="1">
<li>Enter Service Name (e.g., EDWP) and Password, then OK. This should complete the connection.</li>
<li>Add a separate connection for each data source that you will be needing to access (e.g., EDWP, EDWQA, EDWD, etc).</li>
</ol>
</section>
<section id="create-local-folder-for-repositories" class="level1">
<h1>Create Local Folder for Repositories</h1>
<p>To store your GitHub repos, you should create a folder named “Github” that is in your Documents folder but <strong>NOT on your OneDrive</strong>. In other words, this folder should be <em>on your local drive in a place that is not synched via OneDrive</em>. This is because GitHub takes care of synching, and you do not want OneDrive also managing the synching process separately.</p>
<ul>
<li><p>Note that you actually have two Documents folders on your machine. Most likely, the one you typically use is synched via OneDrive. You can tell by looking at the file path in File Explorer. <strong>If the path says “OneDrive” and/or “&lt;username&gt; – CDE Colorado”, then</strong> <strong>this is NOT the folder you want to use for GitHub (see below).</strong></p></li>
<li><p><strong>You can navigate to your <em>local</em> drive using the file path shown below (but with your username)</strong>. Here you can see the full file path for my local Documents folder. You should add this location to your quick access bar so it’s easy to get to. Create your Github folder here. This is where all cloned repositories will be stored.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path-01.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="clone-github-repos-to-your-local-folder" class="level1">
<h1>Clone GitHub Repo(s) to Your Local Folder</h1>
<p>If you’re new to GitHub, you may want to read <a href="https://docs.github.com/en/repositories/creating-and-managing-repositories/about-repositories">this helpful resource</a> that explains the basics of a repository (“repo”) and some associated terminology.</p>
<p>You will access and collaborate with code by cloning a repository to your local Github folder. Cloning a repo means that all files in the repository are copied to your local machine and then monitored by Git for any changes you or others make to the code.</p>
<p>There are several ways to clone and manage a Repo. Most IDEs such as R Studio can handle version control using Git within the app, but I find GitHub Desktop to provide the most intuitive interface, even if it means using a separate app. Further, if there are conflicts between code versions that need to be resolved, this is much easier in GitHub desktop. You can set up multiple systems, including using command line prompts in Git bash or the terminal. It’s up to you what you use, but I will provide instructions here for GitHub Desktop as I think it’s the easiest place to start.</p>
<p>Follow these steps to clone an existing repo to your machine.</p>
<ol type="1">
<li>Sign into GitHub in your browser and in GitHub Desktop</li>
<li>In the browser, navigate to the main page of the repo.</li>
<li>Above the list of files, click <strong>&lt;&gt; Code</strong></li>
<li>Click <strong>Open with GitHub Desktop</strong></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/git1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<ol start="5" type="1">
<li>This will open a window in your GitHub Desktop app. Next, click <strong>Choose</strong> and navigate to the local GitHub folder you created in the prior step. The path should look like my example but with your username. Then click <strong>Clone.</strong></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/git2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<ol start="6" type="1">
<li>Each repo you clone or create will have its own folder within the local Github folder that you created on your machine. Repos may also have project folders within them. There are a variety of theories on how to organize repos. If a project is sufficiently large and distinct from other projects, it may warrant a separate repo. For quick one-off analyses and explorations, I prefer to use a single repo that contains separate projects. Note that developing an R package requires its own repo. I don’t cover creating a new repo here, but you can find plenty of information within GitHub documentation.</li>
</ol>
<section id="basic-principles-of-version-control-using-git" class="level2">
<h2 class="anchored" data-anchor-id="basic-principles-of-version-control-using-git">Basic Principles of Version Control using Git</h2>
<p><strong>IMPORTANT</strong>: <strong><em>Git should only synchronize code (text files), never data</em></strong>. Project folders in your repos will often contain data files, but these should be ignored by Git and not synced. This is accomplished through “.gitignore” files that exist in every repo (and often in individual projects). These files tell Git what files and folders to ignore when syncing. Typically, you won’t need to worry about altering the .gitignore files, but if you notice that GitHub Desktop is trying to sync a file that isn’t code (e.g., data, pdf files, etc.), then you can add code to .gitignore as needed.</p>
<p>When you make changes to code, these are not automatically synced to the main repository on GitHub. At first, they exist only on your local machine. In order to be synced to the repo, changes must first be <strong>committed</strong> and then <strong>pushed</strong>.</p>
<p>Below is a basic outline of the process for working with code using Git. You should do this frequently to avoid being out of sync with the main repo if other collaborators are also making changes! Note that you can do a lot with GitHub…this is just the most basic workflow:</p>
<ol type="1">
<li><strong>Fetch Latest Changes:</strong> Before starting work on a project, make sure you have the latest changes to the main repo synced with your local machine. Click the <em>Fetch origin</em> button to check for and download any updates from the remote repository.</li>
<li><strong>Review Local Changes:</strong> GitHub Desktop displays modified, added, or deleted files in the left panel, allowing you to review differences using the built-in diff viewer.</li>
<li><strong>Commit Your Work:</strong> Whenever you make changes to code, GitHub desktop will sense them and provide an overview of what files have been changed. When you’re ready to send a batch of changes to the remote repo, enter a descriptive commit message in the commit summary box in GitHub Desktop and click <em>Commit to [branch name]</em> to save your changes locally.</li>
<li><strong>Push Your Commits:</strong> Once you’ve committed your changes, click <em>Push origin</em> to update the remote repository with your work.</li>
</ol>
</section>
</section>
<section id="install-r-packages" class="level1">
<h1>Install R Packages</h1>
<p>R packages are collections of functions, data, and documentation that extend the capabilities of R. They make it easy to perform specialized tasks—like data visualization, statistical modeling, or working with specific data formats—without having to write all the code from scratch.</p>
<section id="how-to-install-and-load-packages" class="level2">
<h2 class="anchored" data-anchor-id="how-to-install-and-load-packages">How to Install and Load Packages</h2>
<p>You can install packages separately or together using the <code>install.packages</code> command. To install more than one at once, simply concatenate them. Quotes are needed for package installation, as you see below. You generally will only have to install packages once, but they have to loaded for use in each project.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>) <span class="co"># install one package at a time</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"tidyverse"</span>,<span class="st">"keyring"</span>)) <span class="co"># install multiple packages at once</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To load a package, use the <code>library</code> command without quotes around the package name. Note that you cannot load multiple packages as once by concatenating them as in the example above. One option is to load packages separately, as below:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keyring)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Another option is to create a vector of package names then use <code>lapply</code> to load them, as seen here:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"keyring"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(packages, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note: In some cases you won’t see packages loaded at the start of an R script. This is typically because the packages are being loaded behind the scenes. For example, in a project using renv</p>
</section>
<section id="overview-of-required-packages" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-required-packages">Overview of Required Packages</h2>
<p>At a minimum, the keyring package and either DBI/ODBC or RODBC are required to access warehouse data. The other packages on this list are used commonly across projects.</p>
<ul>
<li><strong><code>keyring</code></strong>: this package manages login credentials so that they do not appear in any syntax files synced to GitHub.</li>
<li><strong><code>DBI</code></strong>: a database interface package used in more recent CDE scripts to access the database directly through the connections pane in R Studio. Using this package, a connection is opened to the database and separate SQL scripts are read into R to pull data. These SQL scripts typically exist in the “src” folder of a R project. More on this setup can be found below.</li>
<li><strong><code>ODBC</code></strong>: an efficient interface for Open Database Connectivity (ODBC) drives. Works in conjunction with the <code>DBI</code> package to query data using SQL scripts.</li>
<li><strong><code>RODBC</code></strong>: this package is used in some older projects to access the database by including a SQL query directly in the R script. We have moved away from this strategy in favor of using <code>DBI</code> to connect dynamically to the database and maintain SQL scripts in separate files, but some older code may not yet be updated.</li>
<li><strong><code>renv</code></strong>: used to create reproducible environments for R projects. Earlier projects in the ACI-Syntax repo do not use renv, but more recent projects typically do unless they are short, one-off analyses. See below for more info on using <code>renv</code>.</li>
<li><strong><code>tidyverse</code></strong>: this is a collection of packages designed for data science that share underlying structure and grammar. Nearly every file in our CDE repos relies on tidyverse packages. Commonly used packages that are part of tidyverse include <code>ggplot</code>, <code>dplyr</code>, <code>stringr</code>, <code>readr</code>, &amp; <code>tidyr</code>. You can install and load these individually, but I find it’s best just to load the entire <code>tidyverse</code>.</li>
</ul>
</section>
<section id="using-renv" class="level2">
<h2 class="anchored" data-anchor-id="using-renv">Using <code>renv</code></h2>
<p><code>renv</code> stands for “R environment” and is a package designed to manage and ensure reproducibility of R projects by tracking and isolating project-specific package dependencies. It creates an isolated project environment that captures the exact versions of packages you’re using, allowing you and others to consistently recreate the environment and avoid conflicts caused by different package versions. All packages needed for a project are installed (if needed) and loaded with a single command. Using <code>renv</code>, you can easily snapshot your current package setup, restore packages exactly as recorded, and share your project knowing it will reliably run in other locations, which serves the ultimate goal of enhancing collaboration and reproducibility in R workflows.</p>
<p>You do not have to use <code>renv</code>, but most recent projects in the CDE repos currently use it, and it must be installed in order to work in those projects.</p>
<p>We have developed a specific project structure using renv that will be described later in this document. Below is a condensed version of this. You may want to do some background reading on renv <a href="https://rstudio.github.io/renv/articles/renv.html">here</a>.</p>
<p>R projects that use renv are in their own folder within the repo and they should have a source folder called “src”. Within this is folder is a file called <code>lib.R</code>. At the top of most R files in a <code>renv</code> project, you will see that this library file is sourced at the top of the file, as seen below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"src/lib.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Part of this library file is the <code>renv::restore</code> command that loads the environment and a series of <code>library</code> commands that load required packages.</p>
</section>
</section>
<section id="set-up-keyring-package" class="level1">
<h1>Set Up <code>keyring</code> Package</h1>
<p>The <code>keyring</code> package is used to avoid having login credentials in plain text in script files. This package uses the Windows (or MacOS) credentialing system to access the necessary tokens, meaning that you unlock the keyring when you log into your machine. <code>keyring</code> enables the same syntax to be used across machines as long as the user has properly set up their keyring with their own login credentials.</p>
<ul>
<li><p>The setup process is simple and only needs to be done once (unless your credentials change).</p></li>
<li><p>It is strongly recommended that your credentials be the same for each warehouse environment you use (e.g., EDWQA, EDWP, etc). The process here is designed to work this way. It is possible to have different username/password combinations, but that will entail alterations to the setup code and the code used to connect to the database.</p></li>
<li><p>You only need to run three lines of code, shown below. There is also a <code>keyring_setup.R</code> file with this code in the ACI-Syntax repository. Running each line of this code will bring up an API window in R Studio that asks for your credentials. After running this code once, your credentials will be accessed by R whenever you connect to the warehouse.</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keyring)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>keyring<span class="sc">::</span><span class="fu">key_set</span>(<span class="st">"WAREHOUSE"</span>, <span class="st">"uid"</span>, <span class="at">prompt =</span> <span class="st">"Username"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>keyring<span class="sc">::</span><span class="fu">key_set</span>(<span class="st">"WAREHOUSE"</span>, <span class="st">"pwd"</span>, <span class="at">prompt =</span> <span class="st">"Password"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="query-data-from-cde-warehouse" class="level1">
<h1>Query Data from CDE Warehouse</h1>
<p>The process below describes our most recent method for pulling data from the warehouse into R.</p>
<ol type="1">
<li>Open a connection to the warehouse. This code uses <code>dbConnect</code> from the <code>DBI</code> package as well as <code>odbc</code>. Username and password are retrieved using the <code>keyring</code> package so that they do not appear in your scipt.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">odbc</span>(), <span class="at">dsn =</span> <span class="st">"EDWQA"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">uid =</span> <span class="fu">key_get</span>(<span class="st">"WAREHOUSE"</span>, <span class="st">"uid"</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pwd =</span> <span class="fu">key_get</span>(<span class="st">"WAREHOUSE"</span>, <span class="st">"pwd"</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">timeout =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>Write a separate script with the SQL query. These are usually stored in the “src” folder withing the project. Many of these SQL queries can be used across projects, so I find it helpful to maintain a folder of SQL scripts that I can draw from when needed. When pulling from multiple tables, you can perform joins either in SQL or in R. I typically use R to join data unless running the join in SQL means having to pull substantially less data from the warehouse.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- this script is saved in a file named ada_sch.sql</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> ADA_SCH_BY_YEAR.DASY_KEY,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.DDST_DIST_NUMBER,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.DDST_DISTRICT_NAME,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.DSCH_SCHOOL_NUMBER,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.DSCH_SCHOOL_NAME,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.DSCH_GRADE_SPAN_LOW,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.DSCH_GRADE_SPAN_HIGH,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.ALT_ED_CAMPUS_YN,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.ONLINE_YN,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.MAGNET_YN,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.CHARTER_YN,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.INNOVATION_YN,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.HOME_SCH_OPTIONS_YN,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.SETTING,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>       ADA_SCH_BY_YEAR.REGION</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> EDW_DATA_MART.ADA_SCH_BY_YEAR ADA_SCH_BY_YEAR</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> ((ADA_SCH_BY_YEAR.DASY_KEY <span class="kw">BETWEEN</span> <span class="dv">2016</span> <span class="kw">AND</span> <span class="dv">2024</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> (ADA_SCH_BY_YEAR.INCLUDED_ACCREDITATION <span class="op">=</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li>Create a new R object using the connection you made in the first step and the SQL file you created in the second step. This will result in an R data frame object containing the data from your query!</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_sch <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="fu">readLines</span>(<span class="st">"src/ada_sch.sql"</span>) <span class="sc">|&gt;</span> <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>